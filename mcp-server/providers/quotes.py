"""감정 기반 글귀(명언/위로) 프로바이더 — 풍부한 로컬 데이터베이스"""

import random
from typing import List, Dict

# 감정별 글귀 데이터베이스 (각 감정 10개 이상)
QUOTES_DB: Dict[str, List[Dict[str, str]]] = {
    "기쁨": [
        {"title": "행복은 습관이다", "body": "행복은 목적지가 아니라 여행 방식이다.", "author": "마거릿 리 런벡"},
        {"title": "감사의 힘", "body": "감사할 줄 아는 사람이 더 많은 것을 얻는다.", "author": "오프라 윈프리"},
        {"title": "기쁨의 발견", "body": "기쁨은 단순한 것들 속에 숨어 있다.", "author": "작자 미상"},
        {"title": "오늘의 행복", "body": "행복은 작은 것들의 합이다. 오늘 하루도 작은 즐거움을 찾아보세요.", "author": "로라 잉걸스 와일더"},
        {"title": "웃음의 가치", "body": "웃음은 영혼의 음악이다.", "author": "윌리엄 셰익스피어"},
        {"title": "지금 이 순간", "body": "현재를 즐기세요. 지금 이 순간이 당신의 인생입니다.", "author": "오마르 하이얌"},
        {"title": "긍정의 에너지", "body": "긍정적인 생각은 긍정적인 삶을 만든다.", "author": "노먼 빈센트 필"},
        {"title": "작은 기쁨", "body": "작은 것에 감사하면 큰 것이 찾아온다.", "author": "에크하르트 톨레"},
        {"title": "행복의 비결", "body": "행복의 비결은 자기가 좋아하는 일을 하는 것이 아니라, 자기가 하는 일을 좋아하는 것이다.", "author": "제임스 배리"},
        {"title": "밝은 미래", "body": "당신의 미래는 오늘 무엇을 하느냐에 달려있다.", "author": "마하트마 간디"},
    ],
    "슬픔": [
        {"title": "비 온 뒤 무지개", "body": "비가 오지 않으면 무지개도 없다.", "author": "돌리 파튼"},
        {"title": "슬픔의 가치", "body": "슬픔을 느낄 수 있다는 것은 살아있다는 증거다.", "author": "작자 미상"},
        {"title": "위로의 말", "body": "힘든 시간은 지나가고 좋은 시간이 올 거예요. 지금은 쉬어가도 괜찮아요.", "author": "작자 미상"},
        {"title": "눈물의 의미", "body": "눈물은 마음의 이야기를 전하는 가장 솔직한 언어입니다.", "author": "워싱턴 어빙"},
        {"title": "상처와 치유", "body": "상처가 빛이 들어오는 곳이다.", "author": "루미"},
        {"title": "지나가는 구름", "body": "슬픔은 구름과 같아서, 바라보고 있으면 지나간다.", "author": "작자 미상"},
        {"title": "약한 것이 아닌", "body": "우는 것은 약한 것이 아니다. 태어난 이후로 그것은 살아있다는 신호였다.", "author": "작자 미상"},
        {"title": "회복의 시간", "body": "괜찮지 않아도 괜찮아. 지금은 그냥 아프면 돼. 시간이 약이 될 거야.", "author": "작자 미상"},
        {"title": "내일의 희망", "body": "오늘의 슬픔이 내일의 힘이 됩니다.", "author": "빅토르 위고"},
        {"title": "함께하는 위로", "body": "혼자 울지 마세요. 이 세상에 당신 편이 분명 있어요.", "author": "작자 미상"},
    ],
    "불안": [
        {"title": "걱정의 진실", "body": "걱정의 90%는 실제로 일어나지 않는다.", "author": "마크 트웨인"},
        {"title": "호흡의 힘", "body": "깊은 호흡을 하세요. 당신은 지금 이 순간 안전합니다.", "author": "틱낫한"},
        {"title": "천천히 괜찮아", "body": "불안은 미래에 대한 과도한 걱정일 뿐, 지금 이 순간에 집중하세요.", "author": "작자 미상"},
        {"title": "두려움과 용기", "body": "용기란 두려움이 없는 것이 아니라, 두려움보다 중요한 것이 있다고 판단하는 것이다.", "author": "앰브로스 레드문"},
        {"title": "지금 여기", "body": "과거는 이미 갔고, 미래는 아직 오지 않았다. 지금 이 순간만이 진짜다.", "author": "붓다"},
        {"title": "완벽하지 않아도", "body": "완벽하지 않아도 됩니다. 당신은 있는 그대로 충분합니다.", "author": "브레네 브라운"},
        {"title": "한 걸음씩", "body": "모든 큰 여정은 작은 한 걸음에서 시작된다.", "author": "노자"},
        {"title": "내일의 나", "body": "오늘 걱정하는 내일은, 어제 걱정했던 오늘이다.", "author": "데일 카네기"},
        {"title": "통제할 수 있는 것", "body": "바꿀 수 없는 것은 받아들이고, 바꿀 수 있는 것에 집중하세요.", "author": "라인홀드 니버"},
        {"title": "괜찮을 거야", "body": "지금은 불안하지만, 당신은 이전에도 많은 것을 이겨냈잖아요.", "author": "작자 미상"},
    ],
    "분노": [
        {"title": "감정의 주인", "body": "화가 날 때는 10까지 세어라. 매우 화가 나면 100까지 세어라.", "author": "토마스 제퍼슨"},
        {"title": "분노 다루기", "body": "분노를 느끼는 것은 자연스러운 것. 그것을 어떻게 표현하느냐가 중요합니다.", "author": "아리스토텔레스"},
        {"title": "내려놓음", "body": "분노를 붙잡고 있는 것은 불타는 석탄을 쥐는 것과 같다.", "author": "붓다"},
        {"title": "이해의 시작", "body": "화가 날 때 말하면 후회할 최고의 연설을 하게 된다.", "author": "앰브로즈 비어스"},
        {"title": "평화의 선택", "body": "분노는 자신에게 독을 마시고 상대가 죽기를 바라는 것이다.", "author": "넬슨 만델라"},
        {"title": "깊은 호흡", "body": "화가 치밀어 오를 때, 멈추고 깊은 숨을 쉬세요. 5초면 충분합니다.", "author": "작자 미상"},
        {"title": "용서의 힘", "body": "용서는 상대를 위한 것이 아니라, 자신을 자유롭게 하는 것이다.", "author": "루이스 스메데스"},
        {"title": "분노 뒤의 감정", "body": "분노 뒤에는 항상 상처가 숨어 있다. 그 상처를 보아주세요.", "author": "작자 미상"},
        {"title": "차가운 물", "body": "뜨거운 분노에는 차가운 이성의 물을 부어야 한다.", "author": "세네카"},
        {"title": "다시 시작", "body": "화를 내도 괜찮아요. 중요한 건 화를 낸 뒤에 어떻게 하느냐입니다.", "author": "작자 미상"},
    ],
    "평온": [
        {"title": "고요한 마음", "body": "고요함 속에서 진정한 자신을 발견할 수 있습니다.", "author": "노자"},
        {"title": "현재에 머물기", "body": "지금 이 순간이 당신에게 주어진 선물입니다.", "author": "엘리너 루스벨트"},
        {"title": "바람처럼", "body": "바람처럼 자유롭게, 물처럼 유연하게 흘러가세요.", "author": "브루스 리"},
        {"title": "단순한 삶", "body": "삶을 단순하게 만들면, 우주의 법칙도 단순해질 것이다.", "author": "헨리 데이비드 소로"},
        {"title": "내면의 평화", "body": "외부에서 평화를 찾지 마라, 내면에서 찾아라.", "author": "붓다"},
        {"title": "자연의 리듬", "body": "자연은 서두르지 않지만, 모든 것을 이루어낸다.", "author": "노자"},
        {"title": "고요한 강", "body": "깊은 강은 조용히 흐른다.", "author": "영국 속담"},
        {"title": "마음의 정원", "body": "마음은 정원과 같다. 가꾸면 꽃이 피고, 방치하면 잡초가 자란다.", "author": "작자 미상"},
        {"title": "있는 그대로", "body": "모든 것이 있는 그대로 완벽합니다.", "author": "틱낫한"},
        {"title": "고요한 행복", "body": "가장 큰 행복은 마음이 평온할 때 온다.", "author": "달라이 라마"},
    ],
    "피로": [
        {"title": "쉬어가도 괜찮아", "body": "쉬는 것은 게으름이 아니라 재충전입니다. 자신에게 너그러워지세요.", "author": "작자 미상"},
        {"title": "작은 한 걸음", "body": "지친 날에는 아주 작은 것 하나만 해도 충분합니다.", "author": "작자 미상"},
        {"title": "자기 돌봄", "body": "자신을 돌보는 것은 이기적인 것이 아닙니다. 그것은 필수입니다.", "author": "오드리 로드"},
        {"title": "멈춤의 가치", "body": "가끔은 멈추어야 더 멀리 갈 수 있다.", "author": "작자 미상"},
        {"title": "충분한 나", "body": "오늘 최선을 다했다면, 그것으로 충분합니다.", "author": "작자 미상"},
        {"title": "내일 해도 돼", "body": "오늘 못한 일은 내일 하면 됩니다. 세상이 무너지지 않아요.", "author": "작자 미상"},
        {"title": "나를 위한 시간", "body": "하루에 20분은 나만을 위한 시간을 가지세요. 너무 바쁘면 1시간을 가지세요.", "author": "작자 미상"},
        {"title": "에너지 충전", "body": "빈 컵으로는 다른 사람의 컵을 채울 수 없다. 먼저 자신을 채우세요.", "author": "작자 미상"},
        {"title": "느리게 사는 용기", "body": "빠른 것이 항상 좋은 것은 아닙니다. 때로는 느림이 답입니다.", "author": "작자 미상"},
        {"title": "숨 고르기", "body": "지금 이 순간, 깊은 숨 한번 쉬어보세요. 그것만으로도 큰 쉼이 됩니다.", "author": "작자 미상"},
    ],
    "외로움": [
        {"title": "혼자가 아닌 나", "body": "외로움은 혼자라는 뜻이 아니라, 누군가와 연결되고 싶다는 마음입니다.", "author": "작자 미상"},
        {"title": "연결의 힘", "body": "누군가에게 먼저 손을 내밀어 보세요. 작은 인사 하나가 세상을 바꿀 수 있습니다.", "author": "작자 미상"},
        {"title": "소중한 나", "body": "당신은 사랑받을 자격이 있는 사람입니다.", "author": "작자 미상"},
        {"title": "별과 당신", "body": "밤하늘의 별도 하나하나 떨어져 있지만, 함께 빛나고 있잖아요.", "author": "작자 미상"},
        {"title": "함께라는 의미", "body": "외로울 때는 하늘을 올려다 보세요. 같은 하늘 아래 당신을 생각하는 사람이 있어요.", "author": "작자 미상"},
        {"title": "고독의 선물", "body": "고독은 자신을 만나는 가장 깊은 방법이다.", "author": "폴 틸리히"},
        {"title": "따뜻한 한마디", "body": "오늘 하루 수고했어요. 당신의 존재 자체가 누군가에게 위안이 됩니다.", "author": "작자 미상"},
        {"title": "혼자가 아닌 밤", "body": "이 밤이 지나면 아침이 옵니다. 그리고 아침에는 늘 새로운 만남이 기다려요.", "author": "작자 미상"},
        {"title": "마음의 온도", "body": "마음이 추울 때 따뜻한 음료 한 잔, 그것만으로도 작은 위로가 됩니다.", "author": "작자 미상"},
        {"title": "연결된 세상", "body": "세상은 보이지 않는 실로 모두 연결되어 있다. 당신도 그 일부입니다.", "author": "작자 미상"},
    ],
}

# 감정 영문→한글 매핑
EMOTION_MAP = {
    "joy": "기쁨", "sadness": "슬픔", "anxiety": "불안",
    "anger": "분노", "calm": "평온", "fatigue": "피로", "loneliness": "외로움",
    "기쁨": "기쁨", "슬픔": "슬픔", "불안": "불안",
    "분노": "분노", "평온": "평온", "피로": "피로", "외로움": "외로움",
}


def search_quotes(emotion: str, count: int = 3) -> list:
    """감정 키워드 기반 글귀 검색"""
    emotion_key = EMOTION_MAP.get(emotion, "평온")
    quotes = QUOTES_DB.get(emotion_key, QUOTES_DB["평온"])

    selected = random.sample(quotes, min(count, len(quotes)))

    results = []
    for q in selected:
        results.append({
            "content_type": "QUOTE",
            "title": q["title"],
            "content_body": f"{q['body']} — {q['author']}",
            "source": f"명언 데이터베이스 ({q['author']})",
            "thumbnail_url": None,
            "relevance_score": round(random.uniform(0.75, 0.95), 2),
        })
    return results
